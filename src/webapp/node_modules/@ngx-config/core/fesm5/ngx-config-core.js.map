{"version":3,"file":"ngx-config-core.js","sources":["ng://@ngx-config/core/config.loader.ts","ng://@ngx-config/core/config.service.ts","ng://@ngx-config/core/config.pipe.ts","ng://@ngx-config/core/config.module.ts"],"sourcesContent":["export abstract class ConfigLoader {\n  abstract loadSettings(): any;\n}\n\nexport class ConfigStaticLoader implements ConfigLoader {\n  constructor(private readonly providedSettings?: any) {\n  }\n\n  loadSettings(): any {\n    return Promise.resolve(this.providedSettings);\n  }\n}\n","import { Injectable } from '@angular/core';\n\nimport { ConfigLoader } from './config.loader';\n\n@Injectable()\nexport class ConfigService {\n  protected settings: any;\n\n  constructor(readonly loader: ConfigLoader) {}\n\n  init(): any {\n    return this.loader.loadSettings().then((res: any) => (this.settings = res));\n  }\n\n  getSettings<T = any>(key?: string | Array<string>, defaultValue?: any): T {\n    if (!key || (Array.isArray(key) && !key[0])) {\n      return this.settings;\n    }\n\n    const paths = !Array.isArray(key) ? key.split('.') : key;\n\n    let result = paths.reduce((acc: any, current: string) => acc && acc[current], this.settings);\n\n    if (result === undefined) {\n      result = defaultValue;\n\n      if (result === undefined) {\n        throw new Error(`No setting found with the specified key [${paths.join('/')}]!`);\n      }\n    }\n\n    return result;\n  }\n}\n","import { Injectable, Pipe, PipeTransform } from '@angular/core';\n\nimport { ConfigService } from './config.service';\n\n@Injectable()\n@Pipe({\n  name: 'config'\n})\nexport class ConfigPipe implements PipeTransform {\n  constructor(private readonly config: ConfigService) {}\n\n  transform(value: string | Array<string>): any {\n    return this.config.getSettings(value);\n  }\n}\n","import { APP_INITIALIZER, Inject, InjectionToken, ModuleWithProviders, NgModule, Optional, SkipSelf } from '@angular/core';\n\nimport { ConfigLoader, ConfigStaticLoader } from './config.loader';\nimport { ConfigPipe } from './config.pipe';\nimport { ConfigService } from './config.service';\n\nexport const configFactory = () => new ConfigStaticLoader();\n\nexport const initializerFactory = (config: ConfigService) => {\n  // workaround for AoT compilation\n  const res = () => config.init();\n\n  return res;\n};\n\nexport const CONFIG_FORROOT_GUARD = new InjectionToken('CONFIG_FORROOT_GUARD');\n\n// tslint:disable-next-line:only-arrow-functions\nexport function provideForRootGuard(config?: ConfigService): any {\n  if (config) {\n    throw new Error(`ConfigModule.forRoot() called twice. Lazy loaded modules should use ConfigModule.forChild() instead.`);\n  }\n\n  return 'guarded';\n}\n\n@NgModule({\n  declarations: [ConfigPipe],\n  exports: [ConfigPipe]\n})\nexport class ConfigModule {\n  static forRoot(\n    configuredProvider: any = {\n      provide: ConfigLoader,\n      useFactory: configFactory\n    }\n  ): ModuleWithProviders<ConfigModule> {\n    return {\n      ngModule: ConfigModule,\n      providers: [\n        configuredProvider,\n        ConfigService,\n        {\n          provide: APP_INITIALIZER,\n          useFactory: initializerFactory,\n          deps: [ConfigService],\n          multi: true\n        },\n        {\n          provide: CONFIG_FORROOT_GUARD,\n          useFactory: provideForRootGuard,\n          deps: [[ConfigService, new Optional(), new SkipSelf()]]\n        }\n      ]\n    };\n  }\n\n  static forChild(): ModuleWithProviders<ConfigModule> {\n    return {\n      ngModule: ConfigModule\n    };\n  }\n\n  // tslint:disable-next-line:no-empty\n  constructor(@Optional() @Inject(CONFIG_FORROOT_GUARD) guard: any) {}\n}\n"],"names":[],"mappings":"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"}